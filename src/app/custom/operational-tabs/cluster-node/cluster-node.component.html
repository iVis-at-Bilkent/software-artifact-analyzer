<div class="d-flex flex-wrap justify-content-center">
    <!-- current rules -->
    <div *ngFor="let r of currRules; let i = index;" class="rounded va-text m-1 p-1"
        [style.border]="r.isEditing ? '2px solid #888888':'2px solid #dee2e6'">
        <div class="text-center">
            <span (click)="editRule(i)" class="pointer">{{r.name}}</span>&nbsp;
            <img src="assets/img/close.svg" class="pointer" (click)="deleteRule(i)" title="Delete query rule">
        </div>
    </div>
    <div class="rounded va-text m-1 p-1" [style.border]="isAddingNewRule ? '2px solid #888888':'2px solid #dee2e6'">
        <div title="New rule" class="text-center" (click)="newRuleClick()">
            <b class="pointer">new</b>&nbsp;<img src="assets/img/add.svg">
        </div>
    </div>
</div>

<div class="form-inline m-2 justify-content-center">
    <input autoSizeInput [includeBorders]="true" [extraWidth]="3" type="text" title="Name" [(ngModel)]="currRuleName"
        class="tight-select filter-form form-control std-inp-hei name-inp m-1 va-small-text">
    <select class="form-select tight-select filter-form va-small-text rule-class" [disabled]="isClassTypeLocked"
        [(ngModel)]="selectedClass" (change)="changeSelectedClass()">
        <option [disabled]="opt.isDisabled" *ngFor="let opt of classOptions" class="rule-class-opt" [value]="opt.text">
            {{opt.text}}
        </option>
    </select>
</div>

<div class="form-inline justify-content-center">
    <span class="va-text">
        Cluster <b *ngIf="selectedClass">{{selectedClass}}</b> by:&nbsp;
    </span>

    <app-rule-dropdown *ngIf="!queryRule || !queryRule.rules" (btnClicked)="initRules($event)"
        [isShowConditionBtn]="true"></app-rule-dropdown>
</div>

<div *ngIf="queryRule && queryRule.rules">
    <app-rule-tree [root]="queryRule.rules" [editedRuleNode]="editedRuleNode" (onOperatorAdded)="newOperator($event)"
        (onRuleRequested)="showPropertyRule($event)" (onEmpty)="queryRuleDeleted()"> </app-rule-tree>

    <!-- rule input -->
    <div *ngIf="isShowPropertyRule">
        <app-property-rule   
        (selectedProperty)="handleSelectedProperty($event)" [propertyChanged]="currProperties"
            [loadRule]="editingPropertyRule" [isStrict]="true">
        </app-property-rule>

    </div>
</div>

<div class="text-center borderless mx-1 my-3">



    <div class="d-flex flex-wrap align-items-center justify-content-center m-1"
        *ngIf="queryRule ">
        <input class="btn btn-sm btn-dark va-text m-1" type="button" [value]="changeBtnTxt" (click)="addOrUpdateRule()">
        <input class="btn btn-sm btn-dark va-text m-1" type="button" value="Execute" (click)="runQuery()">
    </div>

</div>
